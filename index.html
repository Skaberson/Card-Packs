<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card Pack Game</title>
    <style>
        /* General Styles */
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f9;
            margin: 0;
            padding: 20px;
        }
        h1 {
            color: #333;
        }
        .packs {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        .pack {
            width: 100px;
            height: 100px;
            padding: 0;
            background-color: #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, border 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-weight: bold;
            color: #333;
        }
        .pack:hover {
            transform: scale(1.1);
        }
        .pack.completed {
            border: 5px solid gold;
        }

        /* Card Styles */
        .cards {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }
        .card-container {
            width: 100px;
            height: 150px;
            perspective: 1000px;
        }
        .card {
            width: 100%;
            height: 100%;
            border-radius: 10px;
            cursor: pointer;
            position: relative;
            transform-style: preserve-3d;
            transform: rotateY(0);
            transition: transform 0.6s;
            border: 5px solid transparent;
        }
        .card .front,
        .card .back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        .card .front {
            background-color: #555;
            color: white;
        }
        .card .back {
            background-color: white;
            color: black;
            transform: rotateY(180deg);
        }
        .card-flipped {
            transform: rotateY(180deg);
        }
        .card-common { border-color: gray; }
        .card-uncommon { border-color: green; }
        .card-rare { border-color: blue; }
        .card-epic { border-color: purple; }
        .card-legendary { border-color: gold; }
        .card-mythical { border-color: violet; }
        .card-exotic { border-color: cyan; }

        /* Inventory Layout */
        #inventory {
            margin-top: 20px;
        }
        .inventory-section {
            margin: 20px 0;
        }
        .inventory-row {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 10px 0;
        }
        .inventory-card-container {
            width: 100px;
            height: 150px;
            perspective: 1000px;
        }
        .inventory-card {
            width: 100%;
            height: 100%;
            border-radius: 10px;
            position: relative;
            transform-style: preserve-3d;
            transform: rotateY(0);
            transition: transform 0.6s;
            border: 5px solid transparent;
        }
        .inventory-card-locked {
            background-color: #bbb;
        }
        .inventory-card-unlocked {
            cursor: pointer;
        }
        .inventory-card-unlocked.card-common { border-color: gray; }
        .inventory-card-unlocked.card-uncommon { border-color: green; }
        .inventory-card-unlocked.card-rare { border-color: blue; }
        .inventory-card-unlocked.card-epic { border-color: purple; }
        .inventory-card-unlocked.card-legendary { border-color: gold; }
        .inventory-card-unlocked.card-mythical { border-color: violet; }
        .inventory-card-unlocked.card-exotic { border-color: cyan; }

        /* Hide sections until cards are unlocked */
        #exotics-section,
        #mythicals-section,
        #normal-cards-section {
            display: none;
        }

        /* Buttons */
        button {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        #admin-interface {
            display: none;
            margin-bottom: 15px;
        }
        /* Restart button spacing */
        #restart-btn {
            margin-bottom: 10px;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <button id="restart-btn" onclick="confirmRestartProgress()">Restart Progress</button>
    <button onclick="toggleAdminInterface()">Admin Mode</button>
    <div id="admin-interface">
        <input type="password" id="admin-password" placeholder="Enter Code">
        <button onclick="activateAdminCode()">Submit</button>
    </div>
    <h1>Card Pack Game</h1>
    <div id="game">
        <div id="pack-selection">
            <p>Select a pack:</p>
            <div class="packs">
                <div class="pack" id="Fantasy-Pack" onclick="openPack('Fantasy')">Fantasy Pack</div>
                <div class="pack" id="Sci-Fi-Pack" onclick="openPack('Sci-Fi')">Sci-Fi Pack</div>
                <div class="pack" id="Adventure-Pack" onclick="openPack('Adventure')">Adventure Pack</div>
                <div class="pack" id="Mystery-Pack" onclick="openPack('Mystery')">Mystery Pack</div>
                <div class="pack" id="Horror-Pack" onclick="openPack('Horror')">Horror Pack</div>
            </div>
        </div>
        <div id="card-selection" style="display: none;">
            <p>Click on a card to select it:</p>
            <div class="cards" id="cards"></div>
            <button onclick="returnToPacks()">Return to Packs</button>
        </div>
    </div>
    <div id="inventory">
        <h2>Your Inventory</h2>

        <!-- Section for Normal Cards -->
        <div id="normal-cards-section">
            <h3>Normal Cards</h3>
            <div id="normal-cards-container"></div>
        </div>

        <!-- Section for Mythical Cards -->
        <div id="mythicals-section">
            <h3>Mythicals</h3>
            <div id="mythical-cards" class="inventory-row"></div>
        </div>

        <!-- Section for Exotic Cards -->
        <div id="exotics-section">
            <h3>Exotics</h3>
            <div id="exotic-cards" class="inventory-row"></div>
        </div>
    </div>

    <!-- Cookie helpers and progress functions -->
    <script>
    function setCookie(name, value, days) {
        let expires = "";
        if (days) {
            const date = new Date();
            date.setTime(date.getTime() + (days*24*60*60*1000));
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + (encodeURIComponent(value) || "")  + expires + "; path=/";
    }
    function getCookie(name) {
        const nameEQ = name + "=";
        const ca = document.cookie.split(';');
        for (let i = 0; i < ca.length; i++) {
            let c = ca[i];
            while (c.charAt(0) == ' ') c = c.substring(1, c.length);
            if (c.indexOf(nameEQ) == 0) return decodeURIComponent(c.substring(nameEQ.length, c.length));
        }
        return null;
    }
    function eraseCookie(name) {
        document.cookie = name+'=; Max-Age=-99999999;';
    }
    function saveProgress() {
        setCookie('inventory', JSON.stringify(inventory), 365);
        setCookie('unlockedExotics', JSON.stringify(Array.from(unlockedExotics)), 365);
        setCookie('unlockedMythicals', JSON.stringify(Array.from(unlockedMythicals)), 365);
    }
    function loadProgress() {
        let inv = getCookie('inventory');
        let exo = getCookie('unlockedExotics');
        let myth = getCookie('unlockedMythicals');
        if (inv) inventory = JSON.parse(inv);
        if (exo) unlockedExotics = new Set(JSON.parse(exo));
        if (myth) unlockedMythicals = new Set(JSON.parse(myth));
    }
    function clearProgress() {
        eraseCookie('inventory');
        eraseCookie('unlockedExotics');
        eraseCookie('unlockedMythicals');
        inventory = {};
        unlockedExotics = new Set();
        unlockedMythicals = new Set();
        updateInventory();
        saveProgress();
    }
    function confirmRestartProgress() {
        if (confirm('ARE YOU SURE you want to restart your progress? This cannot be undone!')) {
            clearProgress();
        }
    }
    </script>
    <script>
        // Main game code (with cookie and sorting updates)
        const rarities = ['Legendary', 'Epic', 'Rare', 'Uncommon', 'Common', 'Mythical', 'Exotic'];
        // For inventory sorting: Legendary, Epic, Rare, Uncommon, Common (then Mythical, Exotic NOT shown here)
        const inventoryDisplayOrder = ['Legendary', 'Epic', 'Rare', 'Uncommon', 'Common'];

        let rarityChances = [1, 4, 15, 30, 50, 0, 0.1];
        const items = {
            Fantasy: { cards: ['Dragon', 'Wizard', 'Elf', 'Knight', 'Fairy'], exotic: 'Fantasy Phoenix', mythical: 'Golden Dragon' },
            'Sci-Fi': { cards: ['Laser Gun', 'Alien', 'Spaceship', 'Robot', 'Asteroid'], exotic: 'Cosmic Entity', mythical: 'Star Voyager' },
            Adventure: { cards: ['Treasure Chest', 'Pirate', 'Explorer', 'Cave', 'Ancient Relic'], exotic: 'Golden Compass', mythical: 'Lost Relic' },
            Mystery: { cards: ['Secret Map', 'Hidden Path', 'Lost Key', 'Ancient Tome', 'Cryptic Statue'], exotic: 'Mystic Artifact', mythical: 'Ancient Treasure' },
            Horror: { cards: ['Vampire', 'Zombie', 'Werewolf', 'Ghost', 'Haunted Doll'], exotic: 'Cursed Relic', mythical: 'Phantom Blade' }
        };
        let inventory = {};
        let unlockedExotics = new Set();
        let unlockedMythicals = new Set();
        let isAdminMode = false;
        let guaranteeExoticNext = false;

        function toggleAdminInterface() {
            const adminInterface = document.getElementById('admin-interface');
            adminInterface.style.display = adminInterface.style.display === 'none' ? 'block' : 'none';
        }

        function activateAdminCode() {
            const adminInput = document.getElementById('admin-password').value;
            if (adminInput === 'ultra gaming') {
                isAdminMode = true;
                alert('Admin Mode Activated!');
            } else if (adminInput === 'easyrare') {
                rarityChances = [1, 10, 50, 30, 9, 3];
                alert('Easy Rare Mode Activated!');
            } else if (adminInput === 'allcards') {
                unlockAllCards();
                alert('All cards unlocked!');
            } else if (adminInput === 'exoticnow') {
                guaranteeExoticNext = true;
                alert('Your next pack will contain an Exotic card!');
            } else {
                alert('Invalid Code!');
            }
            document.getElementById('admin-password').value = '';
            toggleAdminInterface();
        }

        function unlockAllCards() {
            Object.keys(items).forEach(theme => {
                if (!inventory[theme]) inventory[theme] = {};
                items[theme].cards.forEach(item => {
                    if (!inventory[theme][item]) inventory[theme][item] = new Set(rarities.slice(0, 5));
                });
                unlockedExotics.add(theme);
                unlockedMythicals.add(theme);
            });
            updateInventory();
            saveProgress();
        }

        function openPack(theme) {
            document.getElementById('pack-selection').style.display = 'none';
            document.getElementById('card-selection').style.display = 'block';
            const cardsContainer = document.getElementById('cards');
            cardsContainer.innerHTML = '';
            const cards = [];
            let exoticInserted = false;

            for (let i = 0; i < 5; i++) {
                if (guaranteeExoticNext && !exoticInserted) {
                    const exotic = items[theme].exotic;
                    cards.push({ item: exotic, rarity: 'Exotic' });
                    exoticInserted = true;
                    guaranteeExoticNext = false;
                } else {
                    const item = getRandomItem(theme);
                    const rarity = getRandomRarity();
                    cards.push({ item, rarity });
                }
            }

            cards.forEach(cardData => {
                const cardContainer = document.createElement('div');
                cardContainer.className = 'card-container';
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="front">?</div>
                    <div class="back">${cardData.item} (${cardData.rarity})</div>
                `;
                card.onclick = () => selectCard(card, theme, cardData);
                cardContainer.appendChild(card);
                cardsContainer.appendChild(cardContainer);
            });
        }

        function getRandomItem(theme) {
            const themeItems = items[theme].cards;
            return themeItems[Math.floor(Math.random() * themeItems.length)];
        }

        function getRandomRarity() {
            const random = Math.random() * 100;
            let cumulative = 0;
            for (let i = 0; i < rarities.length; i++) {
                cumulative += rarityChances[i];
                if (random < cumulative) return rarities[i];
            }
            return rarities[rarities.length - 1];
        }

        function selectCard(card, theme, cardData) {
            card.classList.add('card-flipped', `card-${cardData.rarity.toLowerCase()}`);
            addToInventory(theme, cardData.item, cardData.rarity);
        }

        function addToInventory(theme, item, rarity) {
            if (!inventory[theme]) inventory[theme] = {};
            if (!inventory[theme][item]) inventory[theme][item] = new Set();
            inventory[theme][item].add(rarity);
            if (rarity === 'Exotic') unlockedExotics.add(theme);
            if (rarity === 'Mythical') unlockedMythicals.add(theme);
            updateInventory();
            saveProgress();
        }

        function updateInventory() {
            const exoticsRow = document.getElementById('exotic-cards');
            const mythicalsRow = document.getElementById('mythical-cards');
            const normalCardsContainer = document.getElementById('normal-cards-container');
            exoticsRow.innerHTML = '';
            mythicalsRow.innerHTML = '';
            normalCardsContainer.innerHTML = '';

            // Populate Normal Cards Section
            Object.keys(inventory).forEach(theme => {
                const themeSection = document.createElement('div');
                themeSection.className = 'inventory-section';
                themeSection.innerHTML = `<h4>${theme} Pack</h4>`;

                // Construct a list of card objects: [{card, rarity}]
                let allUnlocked = true;
                let cardList = [];
                items[theme].cards.forEach(card => {
                    const raritiesUnlocked = inventory[theme][card] || new Set();
                    // Only push normal rarities
                    inventoryDisplayOrder.forEach(rarity => {
                        if (raritiesUnlocked.has(rarity)) {
                            cardList.push({ card, rarity });
                        }
                    });
                    // For checking all unlocked:
                    if (raritiesUnlocked.size < inventoryDisplayOrder.length) {
                        allUnlocked = false;
                    }
                });

                // Sort by rarity (Legendary, Epic, Rare, Uncommon, Common), then by card name
                cardList.sort((a, b) => {
                    const rA = inventoryDisplayOrder.indexOf(a.rarity);
                    const rB = inventoryDisplayOrder.indexOf(b.rarity);
                    if (rA !== rB) return rA - rB;
                    return a.card.localeCompare(b.card);
                });

                // Render the sorted row
                const row = document.createElement('div');
                row.className = 'inventory-row';
                cardList.forEach(({ card, rarity }) => {
                    const cardContainer = document.createElement('div');
                    cardContainer.className = 'inventory-card-container';

                    const cardElement = document.createElement('div');
                    cardElement.className = `inventory-card inventory-card-unlocked card-${rarity.toLowerCase()}`;
                    cardElement.innerHTML = `
                        <div class="front"></div>
                        <div class="back">${card} (${rarity})</div>
                    `;

                    cardContainer.appendChild(cardElement);
                    row.appendChild(cardContainer);
                });
                themeSection.appendChild(row);

                // Apply golden border if all cards are unlocked
                const packElement = document.getElementById(`${theme}-Pack`);
                if (packElement) {
                    if (allUnlocked) {
                        packElement.classList.add('completed');
                    } else {
                        packElement.classList.remove('completed');
                    }
                }

                normalCardsContainer.appendChild(themeSection);
            });

            // Populate Exotics Row
            unlockedExotics.forEach(theme => {
                const exotic = items[theme].exotic;
                const cardContainer = document.createElement('div');
                cardContainer.className = 'inventory-card-container';

                const card = document.createElement('div');
                card.className = 'inventory-card inventory-card-unlocked card-exotic';
                card.innerHTML = `<div class="front"></div>
                    <div class="back">${exotic} (Exotic)</div>`;
                cardContainer.appendChild(card);
                exoticsRow.appendChild(cardContainer);
            });

            // Populate Mythicals Row
            unlockedMythicals.forEach(theme => {
                const mythical = items[theme].mythical;
                const cardContainer = document.createElement('div');
                cardContainer.className = 'inventory-card-container';

                const card = document.createElement('div');
                card.className = 'inventory-card inventory-card-unlocked card-mythical';
                card.innerHTML = `<div class="front"></div>
                    <div class="back">${mythical} (Mythical)</div>`;
                cardContainer.appendChild(card);
                mythicalsRow.appendChild(cardContainer);
            });

            // Show sections if cards are present
            document.getElementById('exotics-section').style.display = unlockedExotics.size > 0 ? 'block' : 'none';
            document.getElementById('mythicals-section').style.display = unlockedMythicals.size > 0 ? 'block' : 'none';
            document.getElementById('normal-cards-section').style.display = Object.keys(inventory).length > 0 ? 'block' : 'none';
        }

        function returnToPacks() {
            document.getElementById('pack-selection').style.display = 'block';
            document.getElementById('card-selection').style.display = 'none';
        }

        // Load progress on page load
        loadProgress();
        updateInventory();
    </script>
</body>
</html>
